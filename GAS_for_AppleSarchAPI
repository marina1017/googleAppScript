//検索したいappIDをいれておく
var appIDs = [1187265767,396855834]

function myFunction(){
  var appCount = appIDs.length
  
  
  
   var response = UrlFetchApp.fetch('https://itunes.apple.com/lookup?id=1187265767&country=JP');
   //パースさせる
   var json=JSON.parse(response.getContentText());

   Logger.log(json["results"][0]["trackCensoredName"]);
  　　Logger.log(json["results"][0]["description"]);
   var screenshotsCounts = json["results"][0]["screenshotUrls"].length
  
  //スプレッドシートを取得
  var sheet = SpreadsheetApp.getActiveSheet();
  
  //タイトルをスプレッドシートにいれる
  sheet.getRange(1, 1).setValue(json["results"][0]["trackCensoredName"])
  
  //説明をスプレッドシートに入れる
  sheet.getRange(1, 2).setValue(json["results"][0]["description"])
  sheet.getRange(1, 2).setWrap(true)
  sheet.getRange(1, 2).setFontSize(5)
    
    for(var screenshotsNumber = 1; screenshotsNumber <= screenshotsCounts; screenshotsNumber++){
       var func = "IMAGE(\"" + json["results"][0]["screenshotUrls"][screenshotsNumber] + "\")"
       sheet.getRange(1, 2 + screenshotsNumber).setFormula(func)
    }
  
  //説明文を入れるセルの列幅を固定値にする
  sheet.setColumnWidth(2, 400)
  
}
